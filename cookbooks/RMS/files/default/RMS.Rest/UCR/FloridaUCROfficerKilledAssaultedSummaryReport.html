<head>
	<!-- This is a compatibility setting for IE. It tells IE not to run in compatibility mode.
	IE Compatibility mode is IE8 which doesn't seem to play nicely with recent versions of AngularJS.
	-->
	<meta http-equiv="X-UA-Compatible" content="IE=EDGE"/>
    <script src="angular-1.3.5.min.js"></script>
    <script src="ReportPrint.js"></script>
	<script>
        smartCOPPrintArguments = "reportPageOne=rotatedPage";
		var UCRCtrl = function($scope) {
			/*	var xmlhttp;
			if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
				xmlhttp = new XMLHttpRequest();
			} else { // code for IE6, IE5
				xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
			}
			xmlhttp.onreadystatechange = function() {
				if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
					$scope.$apply(function() {
						$scope.UCRReport = JSON.parse(xmlhttp.response).Report;
						$scope.UCRReport.BeginReportingPeriod = dateHelper($scope.UCRReport.BeginReportingPeriod);
						$scope.UCRReport.EndReportingPeriod = dateHelper($scope.UCRReport.EndReportingPeriod);
					});
				}
			}
			xmlhttp.open("GET", "http://localhost/RMS.Rest/GetUCRReportDetail?format=json", true);
			xmlhttp.send();*/

			var dateHelper = function(dateString) {
				var openParen = dateString.indexOf('(');
				var closeParen = dateString.indexOf(')');
				var secondsSinceEpoch = dateString.substring(openParen + 1, closeParen);
				return new Date(parseInt(secondsSinceEpoch));
			}

			$scope.UCRReport = { "AgencyName": "CTS America", "AgencyORI": "CTSA1234", "BeginReportingPeriod": "\/Date(1419890618449)\/", "EndReportingPeriod": "\/Date(1422482618449)\/", "PreparedBy": "Fakey McNotreal", "TelephoneNumber": "(555) 555-5555", "DatePrepared": "\/Date(1422482618449)\/", "Records": [{ "ReportNumber": "Victim01", "IncidentType": "2", "OfficerActivity": "08", "TypeOfAssignment": "6", "WeaponType": "88", "OfficerWearingBodyArmor": "8", "BodyArmorPreventedSeriousInjury": "1", "OffenderUsedOfficersWeapon": "1", "OfficerAwareOffenderHadWeapon": "0", "FirearmDischargedByOffender": "8", "DistanceInFeet": 15, "FirearmDischargedByOfficer": "8", "OffenderInjured": "1", "ExtentOfOffenderInjuries": "4", "Time": "4:03 PM", "OfficerExperienceInYears": 12, "OfficerAge": 35, "OfficerSex": "M", "OfficerRace": "O", "OffenderAge": 47, "OffenderSex": "U", "OffenderRace": "I", "Cleared": "N" }, { "ReportNumber": "Victim02", "IncidentType": "2", "OfficerActivity": null, "TypeOfAssignment": null, "WeaponType": "88", "OfficerWearingBodyArmor": "8", "BodyArmorPreventedSeriousInjury": "1", "OffenderUsedOfficersWeapon": "1", "OfficerAwareOffenderHadWeapon": "0", "FirearmDischargedByOffender": "8", "DistanceInFeet": 15, "FirearmDischargedByOfficer": "8", "OffenderInjured": null, "ExtentOfOffenderInjuries": null, "Time": "0", "OfficerExperienceInYears": 12, "OfficerAge": 35, "OfficerSex": "M", "OfficerRace": "O", "OffenderAge": 0, "OffenderSex": null, "OffenderRace": null, "Cleared": null }, { "ReportNumber": "Offender02", "IncidentType": null, "OfficerActivity": null, "TypeOfAssignment": null, "WeaponType": null, "OfficerWearingBodyArmor": null, "BodyArmorPreventedSeriousInjury": null, "OffenderUsedOfficersWeapon": "1", "OfficerAwareOffenderHadWeapon": null, "FirearmDischargedByOffender": "8", "DistanceInFeet": 15, "FirearmDischargedByOfficer": null, "OffenderInjured": null, "ExtentOfOffenderInjuries": null, "Time": "0", "OfficerExperienceInYears": 0, "OfficerAge": 0, "OfficerSex": null, "OfficerRace": null, "OffenderAge": 47, "OffenderSex": "U", "OffenderRace": "I", "Cleared": null }] };
			$scope.UCRReport.BeginReportingPeriod = dateHelper($scope.UCRReport.BeginReportingPeriod);
			$scope.UCRReport.EndReportingPeriod = dateHelper($scope.UCRReport.EndReportingPeriod);
			$scope.UCRReport.DatePrepared = dateHelper($scope.UCRReport.DatePrepared);
		}

		var UCRApp = angular.module('UCRApp', []);

		UCRApp.controller('UCRCtrl', ['$scope', UCRCtrl]);
	</script>
	<style>
		.center {
			width: 90%;
			margin-left: auto;
			margin-right: auto;
		}

		.bigSpaceBottom {
			margin-bottom: 15px;
		}

		.third {
			float: left;
			width: 33%;
		}

		.bigLabel {
			font: 14px arial, sans-serif;
		}

		.underlinedText {
			border-bottom: 2px solid;
			padding: 2px 20px 3px 20px;
		}

		body {
			font: 12px arial, sans-serif;
		}

		td {
			border: solid 1px;
			text-align: center;
		    font: 12px arial, sans-serif;
		}

		table {
			border-spacing: 0px;
			border-collapse: collapse;
		}

		th {
			border: solid 1px;
		}

		.noBorder {
			border: 0px;
		}

		.blackBorder {
			color: #FFFFFF;
			border: solid 0px;
			background-color: #000000;
		}

		.greyedOut {
			border: solid 0px;
			background-color: #888888;
		}

		.divBorder {
			border: 1px solid black;
		}

		.rotated {
			-webkit-transform: rotate(270deg);
			-moz-transform: rotate(270deg);
			writing-mode: bt-lr;
			white-space: nowrap;
		}
		.textGreyBackground {
			background-color: #F0F0F0;
			font-size: 12px
		}
		.largerTextGreyBackground {
			background-color: #F0F0F0;
			font-size: 13px
		}

        .reportPage {
            height: 1150px;
            width: 1150px;
            margin-bottom: 10px;
        }

        .rotatedPage {
            position: relative;
            left: -250px;

            -webkit-transform: rotate(90deg); /* Safari and Chrome */
            -moz-transform: rotate(90deg); /* Firefox */
            -ms-transform: rotate(90deg); /* IE 9 */
            -o-transform: rotate(90deg); /* Opera */
            transform: rotate(90deg);
        }

        .codesRowOneBox {
            height: 130px;
            float: left;
        }

        .codesRowTwoBox {
            height: 100px;
            float: left;
        }
	</style>
</head>

<body ng-app="UCRApp" ng-controller="UCRCtrl">
    <div id="reportPageOne" class="reportPage">
        <h2 style="text-align: center;">
            Uniform Crime Reports Law Enforcement<br />
            Officer Killed Or Assaulted Report Supplement
        </h2>
        <div class="bigSpaceBottom">
            <div class="third">
                <div class="center">
                    <label class="bigLabel">Agency Name</label>
                    <span class="underlinedText">{{UCRReport.AgencyName}}</span>
                </div>
            </div>
            <div class="third">
                <div class="center">
                    <label class="bigLabel">Agency ORI</label>
                    <span class="underlinedText">{{UCRReport.AgencyORI}}</span>
                </div>
            </div>
            <div class="third">
                <div class="center">
                    <label class="bigLabel">Reporting Period</label>
                    <span class="underlinedText">{{UCRReport.BeginReportingPeriod | date}} - {{UCRReport.EndReportingPeriod | date}}</span>
                </div>
            </div>
            <div class="clearfix"></div>
        </div>
        <br />
        <br />
        <br />
        <div style="width: 1150px;">
            <div class="divBorder" style="float: left; width: 2%; height: 232px">
                <div class="rotated" style="margin: 75px 0px 0px 0px">Codes</div>
            </div>

            <div class="divBorder codesRowOneBox" style="width: 21%;">
                <p align="center" style="margin: 0px"><strong>Incident Type</strong></p>
                <span class="textGreyBackground">1. Officer Killed, Felonious</span><br />
                <span class="textGreyBackground">2. Officer Killed, Accident or Negligence</span><br />
                <span class="textGreyBackground">3. Officer Assaulted, No Injury</span><br />
                <span class="textGreyBackground">4. Officer Assaulted, Minor Injury</span><br />
                <span class="textGreyBackground">5. Officer Assaulted, Serious Injury</span>
            </div>
            <div class="divBorder codesRowOneBox" style="width: 38%;">
                <p align="center" style="margin: 0px"><strong>Officer Activity</strong></p>
                <div style="width: 33%; height: 118px; float: left">
                    <span class="textGreyBackground">01. Responding to Disturbance</span><br />
                    <span class="textGreyBackground">02. Breaking and Entering in Process or Pursuing B&E Suspect</span><br />
                    <span class="textGreyBackground">03. Robbery in Process or Pursuing Robbery Suspect</span>
                </div>
                <div style="width: 33%; height: 118px; float: left">
                    <span class="textGreyBackground">04. Attempting Other Arrests</span><br />
                    <span class="textGreyBackground">05. Civil Disorder</span><br />
                    <span class="textGreyBackground">06. Domestic Disturbance</span><br />
                    <span class="textGreyBackground">07. Handling, Transporting, Custody of Prisoners</span>
                </div>
                <div style="width: 33%; height: 118px; float: left">
                    <span class="textGreyBackground">08. Investiigating Suspicious Persons/Cirsumstances</span><br />
                    <span class="textGreyBackground">09. Ambush, No Warning</span><br />
                    <span class="textGreyBackground">10. Assailant Mentally Deranged</span><br />
                    <span class="textGreyBackground">11. Traffic Pursuit or Stop</span><br />
                    <span class="textGreyBackground">12. Other</span>
                </div>
            </div>
            <div class="divBorder codesRowOneBox" style="width: 440px;">
                <p align="center" style="margin: 0px"><strong>Type of Assignment</strong></p>
                <div style="width: 50%; height: 90px; float: left">
                    <span class="textGreyBackground">1. One Person Vehicle, Alone</span><br />
                    <span class="textGreyBackground">2. One Person Vehicle, Assisted</span><br />
                    <span class="textGreyBackground">3. Two Person Vehicle</span><br />
                    <span class="textGreyBackground">4. Detective or Special Assignment, Alone</span>
                </div>
                <div style="width: 50%; height: 90px; float: left">
                    <span class="textGreyBackground">5. Detective or Special Assignment, Assisted</span><br />
                    <span class="textGreyBackground">6. Traffic, Motorcycle Officer</span><br />
                    <span class="textGreyBackground">7. Other, Alone</span><br />
                    <span class="textGreyBackground">8. Other, Assisted</span>
                </div>
            </div>

            <div class="divBorder codesRowTwoBox" style="width: 29%;">
                <p align="center" style="margin: 0px"><strong>Weapon</strong></p>
                <div style="width: 33%; height: 90px; float: left">
                    <span class="textGreyBackground">00. N/A</span><br />
                    <span class="textGreyBackground">01. Handgun</span><br />
                    <span class="textGreyBackground">02. Rifle</span><br />
                    <span class="textGreyBackground">03. Shotgun</span><br />
                    <span class="textGreyBackground">04. Firearm</span>
                </div>
                <div style="width: 33%; height: 90px; float: left">
                    <span class="textGreyBackground">05. Knife/Cutting Instrument</span><br />
                    <span class="textGreyBackground">06. Blunt Object</span><br />
                    <span class="textGreyBackground">07. Hands/Fist/Feet</span><br />
                    <span class="textGreyBackground">08. Poison</span><br />
                    <span class="textGreyBackground">09. Explosives</span>
                </div>
                <div style="width: 33%; height: 90px; float: left">
                    <span class="textGreyBackground">10. Fire/Incendiary</span><br />
                    <span class="textGreyBackground">13. Drugs</span><br />
                    <span class="textGreyBackground">88. Unknown</span><br />
                    <span class="textGreyBackground">99. Other</span>
                </div>
            </div>
            <div class="divBorder codesRowTwoBox" style="width: 20%;">
                <div style="width: 50%; height: 100px; float: left">
                    <br /><p style="margin: 0px"><strong>Armor Prevent<br />Injury?<br />Officer Aware of<br />Weapon?</strong></p>
                </div>
                <div style="width: 50%; height: 100px; float: left">
                    <br /><span class="textGreyBackground">0. Not Applicable</span><br />
                    <span class="textGreyBackground">1. Yes</span><br />
                    <span class="textGreyBackground">2. No</span><br />
                    <span class="textGreyBackground">8. Unknown</span>
                </div>
            </div>
            <div class="divBorder codesRowTwoBox" style="width: 19%;">
                <div style="width: 50%; height: 100px; float: left">
                    <p style="margin: 0px">
                        <strong>
                            Body Armor?<br />Officer's Weapon<br />Used?
                            <br />Firearm Discharged by Officer?
                            <br />Offender Injured?
                        </strong>
                    </p>
                </div>
                <div style="width: 50%; height: 100px; float: left">
                    <p style="margin: 0px"><strong>Firearm Discharged by Offender?</strong></p><br />
                    <span class="textGreyBackground">1. Yes</span><br />
                    <span class="textGreyBackground">2. No</span><br />
                    <span class="textGreyBackground">8. Unknown</span>
                </div>
            </div>
            <div class="divBorder codesRowTwoBox" style="width: 9%;">
                <p align="center" style="margin: 0px"><strong>Extent of Offender Injuries?</strong></p>
                <div style="width: 50%; height: 90px; float: left">
                    <span class="textGreyBackground">0. Not Applicable</span><br />
                    <span class="textGreyBackground">1. Minor</span><br />
                    <span class="textGreyBackground">2. Moderate</span><br />
                </div>
                <div style="width: 50%; height: 90px; float: left">
                    <span class="textGreyBackground">3. Serious</span><br />
                    <span class="textGreyBackground">4. Fatal</span>
                </div>
            </div>
            <div class="divBorder codesRowTwoBox" style="width: 6%;">
                <p align="center" style="margin: 0px"><strong>Sex</strong></p>
                <span class="textGreyBackground">M- Male</span><br />
                <span class="textGreyBackground">F- Female</span><br />
                <span class="textGreyBackground">U- Unknown (Offender Only)</span>
            </div>
            <div class="divBorder codesRowTwoBox" style="width: 8%;">
                <p align="center" style="margin: 0px"><strong>Race</strong></p>
                <span class="textGreyBackground"><small>W- White</small></span><br />
                <span class="textGreyBackground"><small>B- Black</small></span><br />
                <span class="textGreyBackground"><small>I- American Indian</small></span><br />
                <span class="textGreyBackground"><small>O- Oriental</small></span><br />
                <span class="textGreyBackground"><small>U- Unknown (Offender Only)</small></span>
            </div>
            <div class="divBorder codesRowTwoBox" style="width: 64px;">
                <p align="center" style="margin: 0px"><strong>Cleared</strong></p>
                <span class="textGreyBackground">Y- Yes</span><br />
                <span class="textGreyBackground">N- No</span>
            </div>
        </div>
        <table style="width: 1150px;">
            <thead>
                <tr>
                    <!-- the line breaks are to make row bigger.. probably bad practice -->
                    <td rowspan="2"><span class="largerTextGreyBackground"><br />Report Number<br /><br /></span></td>
                    <td rowspan="2"><span class="largerTextGreyBackground">Incident Type</span></td>
                    <td rowspan="2"><span class="largerTextGreyBackground">Officer Activity</span></td>
                    <td rowspan="2"><span class="largerTextGreyBackground">Type Assignment</span></td>
                    <td rowspan="2"><span class="largerTextGreyBackground">Weapon Type</span></td>
                    <td rowspan="2"><span class="largerTextGreyBackground">Was Officer Wearing Body Armor?</span></td>
                    <td rowspan="2"><span class="largerTextGreyBackground">Did Body Armor Prevent Serious Injury?</span></td>
                    <td rowspan="2"><span class="largerTextGreyBackground">Did Offender Use Officer's Weapon?</span></td>
                    <td rowspan="2"><span class="largerTextGreyBackground">Was Officer Aware Offender Had A Weapon?</span></td>
                    <td rowspan="2"><span class="largerTextGreyBackground">Was A Firearm Discharged By The Offender?</span></td>
                    <td rowspan="2"><span class="largerTextGreyBackground">Distance In Feet (Est.)</span></td>
                    <td rowspan="2"><span class="largerTextGreyBackground">Was A FireArm Discharged By The Officer?</span></td>
                    <td rowspan="2"><span class="largerTextGreyBackground">Was Offender Injured?</span></td>
                    <td rowspan="2"><span class="largerTextGreyBackground">Extent Of Injuries</span></td>
                    <td rowspan="2"><span class="largerTextGreyBackground">Time</span></td>
                    <td rowspan="2"><span class="largerTextGreyBackground">Officer's Experience In Years</span></td>
                    <td colspan="3"><strong>Officer's</strong></td>
                    <td colspan="3"><strong>Offender's</strong></td>
                    <td rowspan="2"><span class="largerTextGreyBackground">Cleared?</span></td>
                </tr>
                <tr>
                    <td><span class="largerTextGreyBackground">Age<br /></span></td>
                    <td><span class="largerTextGreyBackground">Sex</span></td>
                    <td><span class="largerTextGreyBackground">Race</span></td>
                    <td><span class="largerTextGreyBackground">Age</span></td>
                    <td><span class="largerTextGreyBackground">Sex</span></td>
                    <td><span class="largerTextGreyBackground">Race</span></td>
                </tr>
            </thead>
            <tr style="height: 40px;" ng-repeat="record in UCRReport.Records">
                <td>{{record.ReportNumber}}</td>
                <td>{{record.IncidentType}}</td>
                <td>{{record.OfficerActivity}}</td>
                <td>{{record.TypeOfAssignment}}</td>
                <td>{{record.WeaponType}}</td>
                <td>{{record.OfficerWearingBodyArmor}}</td>
                <td>{{record.BodyArmorPreventedSeriousInjury}}</td>
                <td>{{record.OffenderUsedOfficersWeapon}}</td>
                <td>{{record.OfficerAwareOffenderHadWeapon}}</td>
                <td>{{record.FirearmDischargedByOffender}}</td>
                <td>{{record.DistanceInFeet}}</td>
                <td>{{record.FirearmDischargedByOfficer}}</td>
                <td>{{record.OffenderInjured}}</td>
                <td>{{record.ExtentOfOffenderInjuries}}</td>
                <td>{{record.Time}}</td>
                <td>{{record.OfficerExperienceInYears}}</td>
                <td>{{record.OfficerAge}}</td>
                <td>{{record.OfficerSex}}</td>
                <td>{{record.OfficerRace}}</td>
                <td>{{record.OffenderAge}}</td>
                <td>{{record.OffenderSex}}</td>
                <td>{{record.OffenderRace}}</td>
                <td>{{record.Cleared}}</td>
            </tr>
        </table>
        <br />
        <br />
        <div class="bigSpaceBottom">
            <div class="third">
                <div class="center">
                    <label class="bigLabel">Prepared By</label>
                    <span class="underlinedText">{{UCRReport.PreparedBy}}</span>
                </div>
            </div>
            <div class="third">
                <div class="center">
                    <label class="bigLabel">Telephone #</label>
                    <span class="underlinedText">{{UCRReport.TelephoneNumber}}</span>
                </div>
            </div>
            <div class="third">
                <div class="center">
                    <label class="bigLabel">Date Prepared</label>
                    <span class="underlinedText">{{UCRReport.DatePrepared | date}}</span>
                </div>
            </div>
            <div class="clearfix"></div>
        </div>
    </div>
</body>